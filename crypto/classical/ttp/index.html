<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<title>Breaking the Two Time Pad | ångstromCTF Learning Guide</title>

		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
		<link rel="stylesheet" href="/assets/styles/theme.css">
		<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
	</head>
	<body>
		<div class="jumbotron">
      <div class="container">
        <h1 class="display-3">Breaking the Two Time Pad</h1>
				<h2>&aring;ngstromCTF Learning Guide</h2>
      </div>
		</div>

		<div class="container">
			<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script>
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$$','$$']]}});
</script>

<div class="row">
  <div class="col">
    <p>Let’s say that Bob is trying to send a message to Alice <code class="highlighter-rouge">GIVEMEFOOD</code>,
which as a hex string is <code class="highlighter-rouge">474956454d45464f4f44</code>.
He encodes it with the key <code class="highlighter-rouge">56515a5a494c514d4c54</code>,
which gives him the ciphertext <code class="highlighter-rouge">11180c1f040917020310</code>.
He sends this off to Alice, who sends him a CAD of a pepperoni pizza. Bob proceeds to print this out, and they both are happy.</p>

<p>Let’s say Bob wants to send Alice another message <code class="highlighter-rouge">MENEEDRICE</code>, because rice is the ultimate food. Also, piracy of rice CADs has grown exponentially, and as a result the government has banned posting rice CADs online.</p>

<p>Sadly, Bob is a lazy bum so he encodes it with the same key, giving him the ciphertext <code class="highlighter-rouge">1b14141f0c0803040f11</code>.</p>

<p>If Eve gets these two ciphertexts, she can’t do anything because it’s close enough to using the OTP, right? <strong>Wrong</strong>.</p>

<p>Let’s say she guesses the key is the same and XORs the two ciphertexts together. Because the first ciphertext is <code class="highlighter-rouge">Message 1</code> XOR <code class="highlighter-rouge">key</code> and the second ciphertext is <code class="highlighter-rouge">Message 2</code> XOR <code class="highlighter-rouge">key</code>, when we XOR the ciphertexts together we get <code class="highlighter-rouge">Message 1</code> XOR <code class="highlighter-rouge">Message 2</code> XOR <code class="highlighter-rouge">key</code> XOR <code class="highlighter-rouge">key</code>. Because of XOR properties, <code class="highlighter-rouge">key</code> XOR <code class="highlighter-rouge">key</code> cancels, and it is essentially <code class="highlighter-rouge">Message 1</code> XOR <code class="highlighter-rouge">Message 2</code></p>

<p>But if something XOR itself just cancels, if Eve XORs either message with what Eve just got, then that means she can get the other message too!
What’s even worse is that if she guesses part of one message, she can see the corresponding part revealed in the other message and make guesses from there!</p>

<p>A good visual example of the process just described can be found at mixedmath’s response <a href="http://crypto.stackexchange.com/questions/59/taking-advantage-of-one-time-pad-key-reuse">here.</a></p>

<p><strong>TL;DR</strong>: Don’t reuse keys. Key reuse, especially with OTP, makes the messages almost trivial to decipher.</p>


    <br/>
     <a href="/crypto/classical/otp/" style="float: left;">&laquo; The One Time Pad - Perfect Secrecy?</a> 
     <a href="/crypto/modern/" style="float: right;">Modern Cryptography &raquo;</a> 
    <br/><br/>
  </div>

  <div class="col-12 col-md-auto">
    <h3>Navigation</h3>

    <ol class="nav-list">
      <li>
  <a class="active" href="/">Home</a>

  
    <ol>
    
      <li>
  <a  href="/basics/">Basics</a>

  
    <ol>
    
      <li>
  <a  href="/basics/number_systems/">Number Systems</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a  href="/basics/site/">Competition Structure</a>

  
    <ol>
    
      <li>
  <a  href="/basics/site/problems/">Problems and Points</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a  href="/basics/site/site/">Navigating the Website</a>

  
    <ol>
    
    </ol>
  
</li>

    
    </ol>
  
</li>

    
      <li>
  <a  href="/basics/terminal/">The Terminal</a>

  
    <ol>
    
      <li>
  <a  href="/basics/terminal/setup/">Getting Set Up With Terminal</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a  href="/basics/terminal/first/">Your First Terminal Experience</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a  href="/basics/terminal/files/">Files and Directories</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a  href="/basics/terminal/useful/">Useful Commands</a>

  
    <ol>
    
    </ol>
  
</li>

    
    </ol>
  
</li>

    
      <li>
  <a  href="/basics/encodings/">Encodings</a>

  
    <ol>
    
    </ol>
  
</li>

    
    </ol>
  
</li>

    
      <li>
  <a class="active" href="/crypto/">Cryptography</a>

  
    <ol>
    
      <li>
  <a class="active" href="/crypto/classical/">Classical Cryptography</a>

  
    <ol>
    
      <li>
  <a  href="/crypto/classical/caesar/">Caesar Cipher</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a  href="/crypto/classical/otp/">The One Time Pad - Perfect Secrecy?</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a class="active" href="/crypto/classical/ttp/">Breaking the Two Time Pad</a>

  
    <ol>
    
    </ol>
  
</li>

    
    </ol>
  
</li>

    
      <li>
  <a  href="/crypto/modern/">Modern Cryptography</a>

  
    <ol>
    
      <li>
  <a  href="/crypto/modern/aes/">AES</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a  href="/crypto/modern/des/">DES</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a  href="/crypto/modern/rsa/">RSA</a>

  
    <ol>
    
    </ol>
  
</li>

    
    </ol>
  
</li>

    
    </ol>
  
</li>

    
      <li>
  <a  href="/re/">Reverse Engineering</a>

  
    <ol>
    
    </ol>
  
</li>

    
    </ol>
  
</li>

    </ol>
  </div>
</div>


			<footer>
				<br/>
				<hr>
				Copyright &copy; 2016-17 &aring;ngstromCTF.
				<br/><br/>
			</footer>
		</div>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
	</body>
</html>
