<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<title>Caesar Cipher | ångstromCTF Learning Guide</title>

		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
		<link rel="stylesheet" href="/assets/styles/theme.css">
		<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
	</head>
	<body>
		<div class="jumbotron">
      <div class="container">
        <h1 class="display-3">Caesar Cipher</h1>
				<h2>&aring;ngstromCTF Learning Guide</h2>
      </div>
		</div>

		<div class="container">
			<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script>
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$$','$$']]}});
</script>

<div class="row">
  <div class="col">
    <p>One of Julius Caesar’s foremost assets in the wars he fought was, in fact, a simple substition cipher called the <strong>Caesar cipher</strong>. He used to send secret messages to his troops across enemy lines, foreshadowing the essential nature of cryptography in modern warfare and communication in general. The Caesar cipher operates on a simple principle: it takes a plaintext and a key, which is a number between 1 and 25. It might be easiest to illustrate how it works with an example.</p>

<p>Let’s consider the plaintext <code class="highlighter-rouge">ATTACK AT DAWN</code>, the sort of message Caesar might be sending. Caesar always used the key 3, so we might as well use that. What we’re going to do is “add the key to each letter”: since the key is 3, we’ll be replacing <code class="highlighter-rouge">A</code> with <code class="highlighter-rouge">D</code>, <code class="highlighter-rouge">B</code> with <code class="highlighter-rouge">E</code>, <code class="highlighter-rouge">C</code> with <code class="highlighter-rouge">F</code>, all the way around to <code class="highlighter-rouge">W</code> with <code class="highlighter-rouge">Z</code>, <code class="highlighter-rouge">X</code> with <code class="highlighter-rouge">A</code>, <code class="highlighter-rouge">Y</code> with <code class="highlighter-rouge">B</code>, and <code class="highlighter-rouge">Z</code> with <code class="highlighter-rouge">C</code> (it wraps around). If the key was 1, <code class="highlighter-rouge">A</code> would be replaced with <code class="highlighter-rouge">B</code>, if it was 2, <code class="highlighter-rouge">A</code> would be replaced with <code class="highlighter-rouge">C</code>. If it was 13 <code class="highlighter-rouge">A</code> would go to <code class="highlighter-rouge">N</code>. So, our message <code class="highlighter-rouge">ATTACK AT DAWN</code> becomes <code class="highlighter-rouge">DWWDFN DW GDZQ</code>. Caesar sends it to his troops, and even if the enemy general Eve intercepts it, she can’t figure out what it means. All his troops have to do is subtract the key, 3, from each letter, and they’ll get back his original message.</p>

<p>Wow! This is our first cipher. It might seem cool, but it turns out to be really easy to defeat, even for a classical cryptosystem. Now, we’ll consider the <em>cryptanalysis</em> of the Caesar cipher, and try to figure out what some ciphertext means: <code class="highlighter-rouge">Z BEFN KYV XIVVBJ RIV YZUUVE ZE KYV KIFARE YFIJV</code>.</p>

<h3 id="brute-force">Brute-Force</h3>

<p>The first, and easiest, attack that can break the Caesar cipher is a <strong>brute-force</strong> attack. By this, we mean just trying every possible key. There are only 25 of them, so it’s easy to check each one, especially if you have a computer. Let’s do it!</p>

<div class="card">
  <div class="card-block">
    <h4 class="card-title">Brute Force</h4>

    <div class="form-group">
        <label for="ciphertext-brute-force">Plaintext</label>
        <input type="text" class="form-control" id="ciphertext-brute-force" value="Z BEFN KYV XIVVBJ RIV YZUUVE ZE KYV KIFARE YFIJV" oninput="update_brute_force();" />
    </div>

    <br />

    <table class="table table-striped">
        <tr><th style="width: 10%;">Key</th><th style="width: 90%;">Plaintext Attempt</th></tr>
        <tr><td>0</td><td><code id="plaintext0"></code></td></tr>
        <tr><td>1</td><td><code id="plaintext1"></code></td></tr>
        <tr><td>2</td><td><code id="plaintext2"></code></td></tr>
        <tr><td>3</td><td><code id="plaintext3"></code></td></tr>
        <tr><td>4</td><td><code id="plaintext4"></code></td></tr>
        <tr><td>5</td><td><code id="plaintext5"></code></td></tr>
        <tr><td>6</td><td><code id="plaintext6"></code></td></tr>
        <tr><td>7</td><td><code id="plaintext7"></code></td></tr>
        <tr><td>8</td><td><code id="plaintext8"></code></td></tr>
        <tr><td>9</td><td><code id="plaintext9"></code></td></tr>
        <tr><td>10</td><td><code id="plaintext10"></code></td></tr>
        <tr><td>11</td><td><code id="plaintext11"></code></td></tr>
        <tr><td>12</td><td><code id="plaintext12"></code></td></tr>
        <tr><td>13</td><td><code id="plaintext13"></code></td></tr>
        <tr><td>14</td><td><code id="plaintext14"></code></td></tr>
        <tr><td>15</td><td><code id="plaintext15"></code></td></tr>
        <tr><td>16</td><td><code id="plaintext16"></code></td></tr>
        <tr><td>17</td><td><code id="plaintext17"></code></td></tr>
        <tr><td>18</td><td><code id="plaintext18"></code></td></tr>
        <tr><td>19</td><td><code id="plaintext19"></code></td></tr>
        <tr><td>20</td><td><code id="plaintext20"></code></td></tr>
        <tr><td>21</td><td><code id="plaintext21"></code></td></tr>
        <tr><td>22</td><td><code id="plaintext22"></code></td></tr>
        <tr><td>23</td><td><code id="plaintext23"></code></td></tr>
        <tr><td>24</td><td><code id="plaintext24"></code></td></tr>
        <tr><td>25</td><td><code id="plaintext25"></code></td></tr>
    </table>
  </div>
</div>
<p><br /></p>

<script type="text/javascript">
    function update_brute_force() {
        var text = $("#ciphertext-brute-force").val();

        for (var i = 0; i < 26; i++) {
            var ptext = "";

            for (var x = 0; x < text.length; x++) {
                var c = text.charCodeAt(x);

                if (97 <= c && c <= 122) ptext += String.fromCharCode((c-97+(26-i))%26+97);
                else if (65 <= c && c <= 90) ptext += String.fromCharCode((c-65+(26-i))%26+65);
                else ptext += String.fromCharCode(c);
            }

            $("#plaintext"+i).text(ptext);
        }
    }

    update_brute_force();
</script>

<p>As you can see, key 17 corresponds to the ciphertext <code class="highlighter-rouge">I KNOW THE GREEKS ARE HIDDEN IN THE TROJAN HORSE</code>. This is an example of a <strong>ciphertext-only attack</strong>: all we know is the original ciphertext. This is generally the hardest type of attack to carry out.</p>

<h3 id="known-plaintext-attack">Known-Plaintext Attack</h3>

<p>The astute reader will have noticed that, in fact, we do know something about the plaintext corresponding to our message, even without using brute force. The first word of the ciphertext, <code class="highlighter-rouge">Z</code>, is only one letter long. There are only two words in English that are one letter long: <code class="highlighter-rouge">A</code> and <code class="highlighter-rouge">I</code>. Therefore, we can greatly narrow down our search, to only the keys 17 and 25. This is an example of a (partial) <strong>known-plaintext attack</strong>. If we knew the whole plaintext perfectly, it would be even easier to figure out the key.</p>

<h3 id="frequency-analysis">Frequency Analysis</h3>

<p>The Caesar cipher is a simple example of the <em>substitution cipher</em>, where we swap some letters out for other letters. Brute force is easy for the Caesar cipher, since there are only 26 possible keys. But what if there were many more keys? A much more powerful attack that we can use on substitution ciphers is called <strong>frequency analysis</strong>. To understand frequency analysis, first, ask yourself this question: <em>which letter is most common in the English langauge</em>? As you might have guessed, it’s the letter <code class="highlighter-rouge">E</code>. When we look at some ciphertext that’s been encrypted with the Caesar cipher, we only have to look at which letter is most common, and that letter probably corresponds to <code class="highlighter-rouge">E</code>. <code class="highlighter-rouge">E</code> is generally around 12.7% of all English text, followed by <code class="highlighter-rouge">A</code>, <code class="highlighter-rouge">O</code>, and <code class="highlighter-rouge">T</code>, comprising 8.2%, 7.5%, and 9.1% of all letters, respectively.</p>

<p>Frequency analysis is very effective, especially for longer ciphertexts, since short ciphertexts that don’t have many letters might have a skewed distribution (think of it as having a larger sample size). Below, you can test out frequency analysis!</p>

<div class="card">
  <div class="card-block">
    <h4 class="card-title">Frequency Analysis</h4>

    <div class="form-group">
            <label for="text-frequency-analysis">Text</label>
            <textarea class="form-control" id="text-frequency-analysis" rows="15" oninput="update_frequency_analysis();">
MARULLUS
Wherefore rejoice? What conquest brings he home?
What tributaries follow him to Rome,
To grace in captive bonds his chariot-wheels?
You blocks, you stones, you worse than senseless things!
O you hard hearts, you cruel men of Rome,
Knew you not Pompey? Many a time and oft
Have you climb'd up to walls and battlements,
To towers and windows, yea, to chimney-tops,
Your infants in your arms, and there have sat
The livelong day, with patient expectation,
To see great Pompey pass the streets of Rome:
And when you saw his chariot but appear,
Have you not made an universal shout,
That Tiber trembled underneath her banks,
To hear the replication of your sounds
Made in her concave shores?
And do you now put on your best attire?
And do you now cull out a holiday?
And do you now strew flowers in his way
That comes in triumph over Pompey's blood? Be gone!
Run to your houses, fall upon your knees,
Pray to the gods to intermit the plague
That needs must light on this ingratitude.

FLAVIUS
Go, go, good countrymen, and, for this fault,
Assemble all the poor men of your sort;
Draw them to Tiber banks, and weep your tears
Into the channel, till the lowest stream
Do kiss the most exalted shores of all.

[Exeunt all the Commoners]

See whether their basest metal be not moved;
They vanish tongue-tied in their guiltiness.
Go you down that way towards the Capitol;
            </textarea>
          </div>
        <br />

        <table class="table table-striped">
            <tr><th style="width: 10%">Letter</th><th style="width: 20%;">Count</th><th style="width: 20%;">Frequency</th><th style="width: 10%">Letter</th><th style="width: 20%;">Count</th><th style="width: 20%;">Frequency</th></tr>
            <tr><td><code id="letter0"></code></td><td id="count0"></td><td id="frequency0"></td><td><code id="letter13"></code></td><td id="count13"></td><td id="frequency13"></td></tr>
            <tr><td><code id="letter1"></code></td><td id="count1"></td><td id="frequency1"></td><td><code id="letter14"></code></td><td id="count14"></td><td id="frequency14"></td></tr>
            <tr><td><code id="letter2"></code></td><td id="count2"></td><td id="frequency2"></td><td><code id="letter15"></code></td><td id="count15"></td><td id="frequency15"></td></tr>
            <tr><td><code id="letter3"></code></td><td id="count3"></td><td id="frequency3"></td><td><code id="letter16"></code></td><td id="count16"></td><td id="frequency16"></td></tr>
            <tr><td><code id="letter4"></code></td><td id="count4"></td><td id="frequency4"></td><td><code id="letter17"></code></td><td id="count17"></td><td id="frequency17"></td></tr>
            <tr><td><code id="letter5"></code></td><td id="count5"></td><td id="frequency5"></td><td><code id="letter18"></code></td><td id="count18"></td><td id="frequency18"></td></tr>
            <tr><td><code id="letter6"></code></td><td id="count6"></td><td id="frequency6"></td><td><code id="letter19"></code></td><td id="count19"></td><td id="frequency19"></td></tr>
            <tr><td><code id="letter7"></code></td><td id="count7"></td><td id="frequency7"></td><td><code id="letter20"></code></td><td id="count20"></td><td id="frequency20"></td></tr>
            <tr><td><code id="letter8"></code></td><td id="count8"></td><td id="frequency8"></td><td><code id="letter21"></code></td><td id="count21"></td><td id="frequency21"></td></tr>
            <tr><td><code id="letter9"></code></td><td id="count9"></td><td id="frequency9"></td><td><code id="letter22"></code></td><td id="count22"></td><td id="frequency22"></td></tr>
            <tr><td><code id="letter10"></code></td><td id="count10"></td><td id="frequency10"></td><td><code id="letter23"></code></td><td id="count23"></td><td id="frequency23"></td></tr>
            <tr><td><code id="letter11"></code></td><td id="count11"></td><td id="frequency11"></td><td><code id="letter24"></code></td><td id="count24"></td><td id="frequency24"></td></tr>
            <tr><td><code id="letter12"></code></td><td id="count12"></td><td id="frequency12"></td><td><code id="letter25"></code></td><td id="count25"></td><td id="frequency25"></td></tr>
        </table>
    </div>
</div>

<script type="text/javascript">
    function update_frequency_analysis() {
        var text = $("#text-frequency-analysis").val().toUpperCase();

        var counts = [];
        var total = 0;

        for (var i = 0; i < 26; i++) {
            var c = String.fromCharCode(65+i);
            var count = 0;

            for (var j = 0; j < text.length; j++) {
                if (text.charAt(j) == c) count++;
            }

            total += count;

            counts.push([c, count]);
        }

        counts.sort(function (a, b) {
            return b[1] - a[1];
        });

        for (var i = 0; i < 26; i++) {
            $("#letter"+i).text(counts[i][0]);
            $("#count"+i).text(counts[i][1]);
            $("#frequency"+i).text(Math.round(counts[i][1]/total*10000)/100+"%");
        }
    }

    update_frequency_analysis();
</script>



    <br/>
     <a href="/crypto/classical/" style="float: left;">&laquo; Classical Cryptography</a> 
     <a href="/crypto/modern/" style="float: right;">Modern Cryptography &raquo;</a> 
    <br/><br/>
  </div>

  <div class="col-12 col-md-auto">
    <h3>Navigation</h3>

    <ol class="nav-list">
      <li>
  <a class="active" href="/">Home</a>

  
    <ol>
    
      <li>
  <a  href="/basics/">Basics</a>

  
    <ol>
    
      <li>
  <a  href="/basics/number_systems/">Number Systems</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a  href="/basics/encodings/">Encodings</a>

  
    <ol>
    
    </ol>
  
</li>

    
    </ol>
  
</li>

    
      <li>
  <a class="active" href="/crypto/">Cryptography</a>

  
    <ol>
    
      <li>
  <a class="active" href="/crypto/classical/">Classical Cryptography</a>

  
    <ol>
    
      <li>
  <a class="active" href="/crypto/classical/caesar/">Caesar Cipher</a>

  
    <ol>
    
    </ol>
  
</li>

    
    </ol>
  
</li>

    
      <li>
  <a  href="/crypto/modern/">Modern Cryptography</a>

  
    <ol>
    
      <li>
  <a  href="/crypto/modern/aes/">AES</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a  href="/crypto/modern/des/">DES</a>

  
    <ol>
    
    </ol>
  
</li>

    
      <li>
  <a  href="/crypto/modern/rsa/">RSA</a>

  
    <ol>
    
    </ol>
  
</li>

    
    </ol>
  
</li>

    
    </ol>
  
</li>

    
      <li>
  <a  href="/re/">Reverse Engineering</a>

  
    <ol>
    
    </ol>
  
</li>

    
    </ol>
  
</li>

    </ol>
  </div>
</div>


			<footer>
				<br/>
				<hr>
				Copyright &copy; 2016-17 &aring;ngstromCTF.
				<br/><br/>
			</footer>
		</div>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
	</body>
</html>
